---
title: "Prosper Loan Data"
author: "Kevin Green"
date: "August 4th, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(reshape2)
loans <- read.csv('prosperLoanData.csv')

```

<h2>Abstract</h2>
I describe the effects that certain factors play over
<h2>Introduction</h2>
This data set was facilitated by Prosper


```{r}
#Subset data to exclude ambiguous employment status, top 1% earners 
#and bottom 1%
loans2 <- subset(loans, !(EmploymentStatus %in% c('','Not available','Other')))
loans2 <- subset(loans2, StatedMonthlyIncome<quantile(StatedMonthlyIncome, 0.99) 
                 & StatedMonthlyIncome>quantile(StatedMonthlyIncome, 0.01) )

#Creating data frame with means and medians for Loan Amounts
loan.loan_by_income <- loans2 %>%
  group_by(IncomeRange) %>%
  summarise(mean_loan_amount=mean(LoanOriginalAmount),
            median_loan_amount=median(LoanOriginalAmount))

mdata <- melt(loan.loan_by_income, id = c('IncomeRange'))

#Counts for Employment Status
ggplot(loans2, aes(EmploymentStatus)) +
geom_bar(fill = I('#4863A0')) +
geom_text(stat='count', aes(label=..count..), vjust=-0.5)

#Loan Amount by Monthly Income
ggplot(loans2, aes(StatedMonthlyIncome, LoanOriginalAmount))+
  geom_point(alpha=0.20, position=position_jitter())

#Mean loan amount by income range
ggplot(mdata, aes(x = IncomeRange, value, fill = variable))+
  geom_bar(position = 'dodge', stat = 'identity')+
  scale_x_discrete(limits=c('Not employed','$1-24,999','$25,000-49,999','$50,000-74,999',
                            '$75,000-99,999','$100,000+'))

#Is a home owner
ggplot(loans2, aes(IsBorrowerHomeowner))+
  geom_bar()
pie <- bp + coord_polar("y", start=0)
pie

```



